(function(l){var i=this;if(!i.Object||typeof i.Object.keys!="function")throw new ReferenceError("Some [[Iterator]] implementations require the presence of the [[Object]] extensions module [Object.keys].");if(!i.Array||typeof i.Array.make!="function")throw new ReferenceError("Some [[Iterator]] implementations require the presence of the [[Array]] extensions module base [Array.make.detect].");(l||i).Iterator=function(m,n){var o=function(a,c){return function(e){return a.test(c.call(e))}}(/^\[object\s+String\]$/,n.Object.prototype.toString),q=function(a){return a&&typeof a.length=="number"&&isFinite(a.length)},r=function(){var a={};a.constructor.toString=function(){return"[object EoI]"};a.toString=function(){return"EoI"};a.valueOf=function(){return null};return a}(),s=function(a){return function(c){return c===a}}(r);return{EntryIteratorMixin:function(a,c,e,f){return function(){if(a(this)){var b=-1,g=this,j=c(g);this.hasPrevious=function(){return b>0};this.hasNext=function(){return b<g.length-1};this.getPrevious=function(){var d;if(b>0){d=g[--b];d=typeof d!="undefined"||!(b in g)?d:j(g,b)}else{b=-1;d=e}return d};this.getNext=function(){var d;if(b<g.length-1){d=g[++b];d=typeof d!="undefined"||!(b in g)?d:j(g,b)}else{b=g.length;d=e}return d};this.getIndex=function(){return b<g.length&&b>-1?b:e};this.setIndex=function(d){d=~~(1*d);b=d<=-1&&-1||d>=g.length&&g.length||d};this.isEoI=f}return this}}(q,function(a){return o(a)&&function(c,e){return c.charAt(e)}||a&&a.item&&(typeof a.item=="function"||typeof a.item=="object")&&function(c,e){return c.item(e)}||function(c,e,f){return f}},r,s),EntryIterator:function(a,c,e){return function(f){if(a(f)){var b,g=e.Iterator.EntryIteratorMixin;this.compile=function(j){b=g.call(c(j));this.hasPrevious=b.hasPrevious;this.hasNext=b.hasNext;this.getPrevious=b.getPrevious;this.getNext=b.getNext;this.getIndex=b.getIndex;this.setIndex=b.setIndex;this.isEoI=b.isEoI;this.size=function(){return b.length};return this};return this.compile(f)}}}(q,n.Array.make,m),PropertyIterator:function(a,c){return function(e){var f,b=c.Iterator.EntryIteratorMixin,g,j,d,k;this.compile=function(p){f=b.call(a(p));g=f.getPrevious;j=f.getNext;d=f.getIndex;k=f.isEoI;this.hasPrevious=f.hasPrevious;this.hasNext=f.hasNext;this.getPrevious=function(){var h=g();return!k(h)?p[h]:h};this.getNext=function(){var h=j();return!k(h)?p[h]:h};this.getKey=function(){var h=d();return!k(h)?f[h]:h};this.isEoI=k;this.size=function(){return f.length};return this};return this.compile(e)}}(n.Object.keys,m),mixin:function(a,c){if(c&&(typeof c=="object"||typeof c=="function")){var e=m.Iterator;if(o(a)&&typeof e[a+"Mixin"]=="function")e[a+"Mixin"].call(c);else typeof a=="function"&&a.call(c)}return c},create:function(a,c){var e,f=m.Iterator;if(c&&(typeof c=="object"||typeof c=="function"))if(o(a)&&typeof f[a]=="function")e=new f[a](c);else if(typeof a=="function")e=new a(c);return e}}}(l||i,i);i=l=null;delete i;delete l;delete arguments.callee}).call(null);
