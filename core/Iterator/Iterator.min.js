(function(j){if(!j.Object||typeof j.Object.keys!="function")throw new ReferenceError("Some [[Iterator]] implementations require the presence of the [[Object]] extensions module [Object.keys].");if(!j.Array||typeof j.Array.make!="function")throw new ReferenceError("Some [[Iterator]] implementations require the presence of the [[Array]] extensions module base [Array.make.detect].");j.Iterator=function(h){var k=h.Object.keys,l=h.Array.make;regXClassName=/^\[object\s+(.*)\]$/;exposeImplementation=h.Object.prototype.toString;isString=function(){var a=/^\[object\s+String\]$/,c=exposeImplementation;return function(d){return a.test(c.call(d))}}();isKindOfList=function(a){return a&&typeof a.length=="number"&&isFinite(a.length)};hasItemMethod=function(a){return a&&a.item&&(typeof a.item=="function"||typeof a.item=="object")};createGetListItemFallbackByCurrentType=function(a){return isString(a)&&function(c,d){return c.charAt(d)}||hasItemMethod(a)&&function(c,d){return c.item(d)}||function(c,d,e){return e}};EndOfIteration=function(){var a={};a.constructor.toString=function(){return"[object EoI]"};a.toString=function(){return"EoI"};a.valueOf=function(){return null};return a}();isEndOfIteration=function(a){return function(c){return c===a}}(EndOfIteration);return{EntryIteratorMixin:function(a,c,d,e){return function(){if(a(this)){var f=-1,g=this,i=c(g);this.hasPrevious=function(){return f>0};this.hasNext=function(){return f<g.length-1};this.getPrevious=function(){var b;if(f>0){b=g[--f];b=typeof b!="undefined"||!(f in g)?b:i(g,f)}else{f=-1;b=d}return b};this.getNext=function(){var b;if(f<g.length-1){b=g[++f];b=typeof b!="undefined"||!(f in g)?b:i(g,f)}else{f=g.length;b=d}return b};this.getIndex=function(){return f<g.length&&f>-1?f:d};this.setIndex=function(b){b=~~(1*b);f=b<=-1&&-1||b>=g.length&&g.length||b};this.isEoI=e}return this}}(isKindOfList,createGetListItemFallbackByCurrentType,EndOfIteration,isEndOfIteration),EntryIterator:function(a,c,d){return function(e){if(a(e)){e=d.Iterator.EntryIteratorMixin.call(c(e));this.hasPrevious=e.hasPrevious;this.hasNext=e.hasNext;this.getPrevious=e.getPrevious;this.getNext=e.getNext;this.getIndex=e.getIndex;this.setIndex=e.setIndex;this.isEoI=e.isEoI;this.size=function(){return e.length}}return this}}(isKindOfList,l,h),PropertyIterator:function(a){return function(c){var d=h.Iterator.EntryIteratorMixin.call(a(c)),e=d.getPrevious,f=d.getNext,g=d.getIndex,i=d.isEoI;this.hasPrevious=d.hasPrevious;this.hasNext=d.hasNext;this.getPrevious=function(){var b=e();return!i(b)?c[b]:b};this.getNext=function(){var b=f();return!i(b)?c[b]:b};this.getKey=function(){var b=g();return!i(b)?d[b]:b};this.isEoI=i;this.size=function(){return d.length};return this}}(k),mixin:function(a,c){if(c&&(typeof c=="object"||typeof c=="function")){var d=h.Iterator;if(isString(a)&&typeof d[a+"Mixin"]=="function")d[a+"Mixin"].call(c);else typeof a=="function"&&a.call(c)}return c},create:function(a,c){var d,e=h.Iterator;if(c&&(typeof c=="object"||typeof c=="function"))if(isString(a)&&typeof e[a]=="function")d=new e[a](c);else if(typeof a=="function")d=new a(c);return d}}}(j);delete arguments.callee})(this&&this.window===this&&window||this);
