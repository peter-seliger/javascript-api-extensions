(function(k){if(!k.Object||typeof k.Object.keys!="function")throw new ReferenceError("Some [[Iterator]] implementations require the presence of the [[Object]] extensions module [Object.keys].");if(!k.Array||typeof k.Array.make!="function")throw new ReferenceError("Some [[Iterator]] implementations require the presence of the [[Array]] extensions module base [Array.make.detect].");k.Iterator=function(i){var n=i.Object.keys,o=i.Array.make;regXClassName=/^\[object\s+(.*)\]$/;exposeImplementation=i.Object.prototype.toString;isString=function(){var a=/^\[object\s+String\]$/,c=exposeImplementation;return function(e){return a.test(c.call(e))}}();isKindOfList=function(a){return a&&typeof a.length=="number"&&isFinite(a.length)};hasItemMethod=function(a){return a&&a.item&&(typeof a.item=="function"||typeof a.item=="object")};createGetListItemFallbackByCurrentType=function(a){return isString(a)&&function(c,e){return c.charAt(e)}||hasItemMethod(a)&&function(c,e){return c.item(e)}||function(c,e,f){return f}};EndOfIteration=function(){var a={};a.constructor.toString=function(){return"[object EoI]"};a.toString=function(){return"EoI"};a.valueOf=function(){return null};return a}();isEndOfIteration=function(a){return function(c){return c===a}}(EndOfIteration);return{EntryIteratorMixin:function(a,c,e,f){return function(){if(a(this)){var b=-1,g=this,j=c(g);this.hasPrevious=function(){return b>0};this.hasNext=function(){return b<g.length-1};this.getPrevious=function(){var d;if(b>0){d=g[--b];d=typeof d!="undefined"||!(b in g)?d:j(g,b)}else{b=-1;d=e}return d};this.getNext=function(){var d;if(b<g.length-1){d=g[++b];d=typeof d!="undefined"||!(b in g)?d:j(g,b)}else{b=g.length;d=e}return d};this.getIndex=function(){return b<g.length&&b>-1?b:e};this.setIndex=function(d){d=~~(1*d);b=d<=-1&&-1||d>=g.length&&g.length||d};this.isEoI=f}return this}}(isKindOfList,createGetListItemFallbackByCurrentType,EndOfIteration,isEndOfIteration),EntryIterator:function(a,c,e){return function(f){if(a(f)){var b,g=e.Iterator.EntryIteratorMixin;this.compile=function(j){b=g.call(c(j));this.hasPrevious=b.hasPrevious;this.hasNext=b.hasNext;this.getPrevious=b.getPrevious;this.getNext=b.getNext;this.getIndex=b.getIndex;this.setIndex=b.setIndex;this.isEoI=b.isEoI;this.size=function(){return b.length};return this};return this.compile(f)}}}(isKindOfList,o,i),PropertyIterator:function(a,c){return function(e){var f,b=c.Iterator.EntryIteratorMixin,g,j,d,l;this.compile=function(m){f=b.call(a(m));g=f.getPrevious;j=f.getNext;d=f.getIndex;l=f.isEoI;this.hasPrevious=f.hasPrevious;this.hasNext=f.hasNext;this.getPrevious=function(){var h=g();return!l(h)?m[h]:h};this.getNext=function(){var h=j();return!l(h)?m[h]:h};this.getKey=function(){var h=d();return!l(h)?f[h]:h};this.isEoI=l;this.size=function(){return f.length};return this};return this.compile(e)}}(n,i),mixin:function(a,c){if(c&&(typeof c=="object"||typeof c=="function")){var e=i.Iterator;if(isString(a)&&typeof e[a+"Mixin"]=="function")e[a+"Mixin"].call(c);else typeof a=="function"&&a.call(c)}return c},create:function(a,c){var e,f=i.Iterator;if(c&&(typeof c=="object"||typeof c=="function"))if(isString(a)&&typeof f[a]=="function")e=new f[a](c);else if(typeof a=="function")e=new a(c);return e}}}(k);delete arguments.callee})(this&&this.window===this&&window||this);
