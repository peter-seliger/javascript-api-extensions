var EventTargetProvider=function(){var k=Object.prototype.toString,h=function(a){return a&&a.toString&&a.toString()||""};(function(){var a=/^\[object\s+Boolean\]$/;return function(f){return a.test(k.call(f))}})();var l=function(){var a=/^\[object\s+String\]$/;return function(f){return a.test(k.call(f))}}(),m=function(a){return typeof a=="function"&&typeof a.call=="function"&&typeof a.apply=="function"},n={indexOf:function(a,f){for(var b=a.length-1;b>-1;){if(a[b]===f)break;--b}return b}},o=function(a,f){this.constructor=o;this.target=a;this.type=f;this.timeStamp=new Date},i=function(a,f,b){this.constructor=i;var d=new o(a,f);this.handleEvent=function(c){if(typeof c=="object"&&c){c.target=d.target;c.type=d.type;c.timeStamp=d.timeStamp}else c={target:d.target,type:d.type,timeStamp:d.timeStamp};b(c)};this.getType=function(){return f};this.getHandler=function(){return b}},q=function(){var a={},f=function(b,d){var c=a[b];b=false;if(c){var e=c.handlers;c=c.listeners;d=n.indexOf(e,d);if(d>=0){e.splice(d,1);c.splice(d,1);b=true}}return b};this.addEventListener=function(b,d){var c;if(b&&l(b)&&m(d)){var e=a[b];c=new i(this,b,d);if(e){b=e.handlers;e=e.listeners;d=n.indexOf(b,d);if(d==-1){b.push(c.getHandler());e.push(c);c=c}else c=e[d]}else{e=a[b]={};e.handlers=[c.getHandler()];e.listeners=[c];c=c}}return c};this.removeEventListener=function(b,d){return l(b)&&m(d)&&f(b,d)||b instanceof i&&f(b.getType(),b.getHandler())||false};this.dispatchEvent=function(b){var d=false,c=typeof b=="object"&&typeof b.type=="string"&&b.type||typeof b=="string"&&b;if(c=c&&a[c]){var e=(c=c&&c.listeners)&&c.length||0,p=0;if(e>=1){for(;p<e;)c[p++].handleEvent(b);d=true}}return d}},g=new q,j={addListenerString:g.addEventListener.toString(),removeListenerString:g.removeEventListener.toString(),dispatchEventString:g.dispatchEvent.toString()};delete g;return{register:function(a){typeof a.addEventListener=="function"||a.attachEvent||typeof a.removeEventListener=="function"||a.detachEvent||typeof a.dispatchEvent=="function"||a.fireEvent||q.call(a)},unsubscribe:function(a){h(a.addEventListener)===j.addListenerString&&delete a.addEventListener;h(a.removeEventListener)===j.removeListenerString&&delete a.removeEventListener;h(a.dispatchEvent)===j.dispatchEventString&&delete a.dispatchEvent}}}();