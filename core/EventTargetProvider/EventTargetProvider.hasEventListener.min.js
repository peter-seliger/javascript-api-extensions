var EventTargetProvider=function(){var o=Object.prototype.toString,i=function(a){return a&&a.toString&&a.toString()||""};(function(){var a=/^\[object\s+Boolean\]$/;return function(f){return a.test(o.call(f))}})();var l=function(){var a=/^\[object\s+String\]$/;return function(f){return a.test(o.call(f))}}(),m=function(a){return typeof a=="function"&&typeof a.call=="function"&&typeof a.apply=="function"},n={indexOf:function(a,f){for(var g=a.length-1;g>-1;){if(a[g]===f)break;--g}return g}},p=function(a,f){this.constructor=p;this.target=a;this.type=f;this.timeStamp=new Date},j=function(a,f,g){this.constructor=j;var b=new p(a,f);this.handleEvent=function(c){if(typeof c=="object"&&c){c.target=b.target;c.type=b.type;c.timeStamp=b.timeStamp}else c={target:b.target,type:b.type,timeStamp:b.timeStamp};g(c)};this.getType=function(){return f};this.getHandler=function(){return g}},r=function(){var a={},f=function(b,c){var d=a[b];b=false;if(d){var e=d.handlers;d=d.listeners;c=n.indexOf(e,c);if(c>=0){e.splice(c,1);d.splice(c,1);b=true}}return b},g=function(b,c){return(a[b]||false)&&n.indexOf(a[b].handlers,c)>=0};this.addEventListener=function(b,c){var d;if(b&&l(b)&&m(c)){var e=a[b];d=new j(this,b,c);if(e){b=e.handlers;e=e.listeners;c=n.indexOf(b,c);if(c==-1){b.push(d.getHandler());e.push(d);d=d}else d=e[c]}else{e=a[b]={};e.handlers=[d.getHandler()];e.listeners=[d];d=d}}return d};this.removeEventListener=function(b,c){return l(b)&&m(c)&&f(b,c)||b instanceof j&&f(b.getType(),b.getHandler())||false};this.hasEventListener=function(b,c){return l(b)&&m(c)&&g(b,c)||b instanceof j&&g(b.getType(),b.getHandler())||false};this.dispatchEvent=function(b){var c=false,d=typeof b=="object"&&typeof b.type=="string"&&b.type||typeof b=="string"&&b;if(d=d&&a[d]){var e=(d=d&&d.listeners)&&d.length||0,q=0;if(e>=1){for(;q<e;)d[q++].handleEvent(b);c=true}}return c}},h=new r,k={addListenerString:h.addEventListener.toString(),removeListenerString:h.removeEventListener.toString(),hasListenerString:h.hasEventListener.toString(),dispatchEventString:h.dispatchEvent.toString()};delete h;return{register:function(a){typeof a.addEventListener=="function"||a.attachEvent||typeof a.removeEventListener=="function"||a.detachEvent||typeof a.dispatchEvent=="function"||a.fireEvent||r.call(a)},unsubscribe:function(a){i(a.addEventListener)===k.addListenerString&&delete a.addEventListener;i(a.removeEventListener)===k.removeListenerString&&delete a.removeEventListener;i(a.hasEventListener)===k.hasListenerString&&delete a.hasEventListener;i(a.dispatchEvent)===k.dispatchEventString&&delete a.dispatchEvent}}}();
